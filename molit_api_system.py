import streamlit as st
import pandas as pd
import requests
from xml.etree import ElementTree as ET
from datetime import datetime, timedelta
import time

# í˜ì´ì§€ ì„¤ì •
st.set_page_config(
    page_title="ì „êµ­ ì‹¤ê±°ë˜ê°€ ì´ìƒê±°ë˜ íƒì§€ ì‹œìŠ¤í…œ",
    page_icon="ğŸ ",
    layout="wide"
)

# ì „êµ­ ì‹œë„ ë° ì‹œêµ°êµ¬ ì½”ë“œ
REGION_CODES = {
    'ì„œìš¸íŠ¹ë³„ì‹œ': {
        'ì „ì²´': ['11110', '11140', '11170', '11200', '11215', '11230', '11260', '11290', '11305', '11320', '11350', '11380', '11410', '11440', '11470', '11500', '11530', '11545', '11560', '11590', '11620', '11650', '11680', '11710', '11740'],
        'ì¢…ë¡œêµ¬': ['11110'], 'ì¤‘êµ¬': ['11140'], 'ìš©ì‚°êµ¬': ['11170'], 'ì„±ë™êµ¬': ['11200'], 'ê´‘ì§„êµ¬': ['11215'],
        'ë™ëŒ€ë¬¸êµ¬': ['11230'], 'ì¤‘ë‘êµ¬': ['11260'], 'ì„±ë¶êµ¬': ['11290'], 'ê°•ë¶êµ¬': ['11305'], 'ë„ë´‰êµ¬': ['11320'],
        'ë…¸ì›êµ¬': ['11350'], 'ì€í‰êµ¬': ['11380'], 'ì„œëŒ€ë¬¸êµ¬': ['11410'], 'ë§ˆí¬êµ¬': ['11440'], 'ì–‘ì²œêµ¬': ['11470'],
        'ê°•ì„œêµ¬': ['11500'], 'êµ¬ë¡œêµ¬': ['11530'], 'ê¸ˆì²œêµ¬': ['11545'], 'ì˜ë“±í¬êµ¬': ['11560'], 'ë™ì‘êµ¬': ['11590'],
        'ê´€ì•…êµ¬': ['11620'], 'ì„œì´ˆêµ¬': ['11650'], 'ê°•ë‚¨êµ¬': ['11680'], 'ì†¡íŒŒêµ¬': ['11710'], 'ê°•ë™êµ¬': ['11740']
    },
    'ë¶€ì‚°ê´‘ì—­ì‹œ': {
        'ì „ì²´': ['26110', '26140', '26170', '26200', '26230', '26260', '26290', '26320', '26350', '26380', '26410', '26440', '26470', '26500', '26530', '26710'],
        'ì¤‘êµ¬': ['26110'], 'ì„œêµ¬': ['26140'], 'ë™êµ¬': ['26170'], 'ì˜ë„êµ¬': ['26200'], 'ë¶€ì‚°ì§„êµ¬': ['26230'],
        'ë™ë˜êµ¬': ['26260'], 'ë‚¨êµ¬': ['26290'], 'ë¶êµ¬': ['26320'], 'í•´ìš´ëŒ€êµ¬': ['26350'], 'ì‚¬í•˜êµ¬': ['26380'],
        'ê¸ˆì •êµ¬': ['26410'], 'ê°•ì„œêµ¬': ['26440'], 'ì—°ì œêµ¬': ['26470'], 'ìˆ˜ì˜êµ¬': ['26500'], 'ì‚¬ìƒêµ¬': ['26530'], 'ê¸°ì¥êµ°': ['26710']
    },
    'ëŒ€êµ¬ê´‘ì—­ì‹œ': {
        'ì „ì²´': ['27110', '27140', '27170', '27200', '27230', '27260', '27290', '27710'],
        'ì¤‘êµ¬': ['27110'], 'ë™êµ¬': ['27140'], 'ì„œêµ¬': ['27170'], 'ë‚¨êµ¬': ['27200'],
        'ë¶êµ¬': ['27230'], 'ìˆ˜ì„±êµ¬': ['27260'], 'ë‹¬ì„œêµ¬': ['27290'], 'ë‹¬ì„±êµ°': ['27710']
    },
    'ì¸ì²œê´‘ì—­ì‹œ': {
        'ì „ì²´': ['28110', '28140', '28177', '28185', '28200', '28237', '28245', '28260', '28710', '28720'],
        'ì¤‘êµ¬': ['28110'], 'ë™êµ¬': ['28140'], 'ë¯¸ì¶”í™€êµ¬': ['28177'], 'ì—°ìˆ˜êµ¬': ['28185'], 'ë‚¨ë™êµ¬': ['28200'],
        'ë¶€í‰êµ¬': ['28237'], 'ê³„ì–‘êµ¬': ['28245'], 'ì„œêµ¬': ['28260'], 'ê°•í™”êµ°': ['28710'], 'ì˜¹ì§„êµ°': ['28720']
    },
    'ê´‘ì£¼ê´‘ì—­ì‹œ': {
        'ì „ì²´': ['29110', '29140', '29155', '29170', '29200'],
        'ë™êµ¬': ['29110'], 'ì„œêµ¬': ['29140'], 'ë‚¨êµ¬': ['29155'], 'ë¶êµ¬': ['29170'], 'ê´‘ì‚°êµ¬': ['29200']
    },
    'ëŒ€ì „ê´‘ì—­ì‹œ': {
        'ì „ì²´': ['30110', '30140', '30170', '30200', '30230'],
        'ë™êµ¬': ['30110'], 'ì¤‘êµ¬': ['30140'], 'ì„œêµ¬': ['30170'], 'ìœ ì„±êµ¬': ['30200'], 'ëŒ€ë•êµ¬': ['30230']
    },
    'ìš¸ì‚°ê´‘ì—­ì‹œ': {
        'ì „ì²´': ['31110', '31140', '31170', '31200', '31710'],
        'ì¤‘êµ¬': ['31110'], 'ë‚¨êµ¬': ['31140'], 'ë™êµ¬': ['31170'], 'ë¶êµ¬': ['31200'], 'ìš¸ì£¼êµ°': ['31710']
    },
    'ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ': {
        'ì „ì²´': ['36110'],
        'ì„¸ì¢…ì‹œ': ['36110']
    },
    'ê²½ê¸°ë„': {
        'ì „ì²´': ['41111', '41113', '41115', '41117', '41131', '41133', '41135', '41150', '41171', '41173', '41190', '41210', '41220', '41250', '41271', '41273', '41281', '41285', '41287', '41290', '41310', '41360', '41370', '41390', '41410', '41430', '41450', '41461', '41463', '41465', '41480', '41500', '41550', '41570', '41590', '41610', '41630', '41650', '41670', '41800', '41820', '41830'],
        'ìˆ˜ì›ì‹œ': ['41111', '41113', '41115', '41117'], 'ì„±ë‚¨ì‹œ': ['41131', '41133', '41135'], 'ì˜ì •ë¶€ì‹œ': ['41150'],
        'ì•ˆì–‘ì‹œ': ['41171', '41173'], 'ë¶€ì²œì‹œ': ['41190'], 'ê´‘ëª…ì‹œ': ['41210'], 'í‰íƒì‹œ': ['41220'], 'ë™ë‘ì²œì‹œ': ['41250'],
        'ì•ˆì‚°ì‹œ': ['41271', '41273'], 'ê³ ì–‘ì‹œ': ['41281', '41285', '41287'], 'ê³¼ì²œì‹œ': ['41290'], 'êµ¬ë¦¬ì‹œ': ['41310'],
        'ë‚¨ì–‘ì£¼ì‹œ': ['41360'], 'ì˜¤ì‚°ì‹œ': ['41370'], 'ì‹œí¥ì‹œ': ['41390'], 'êµ°í¬ì‹œ': ['41410'], 'ì˜ì™•ì‹œ': ['41430'],
        'í•˜ë‚¨ì‹œ': ['41450'], 'ìš©ì¸ì‹œ': ['41461', '41463', '41465'], 'íŒŒì£¼ì‹œ': ['41480'], 'ì´ì²œì‹œ': ['41500'],
        'ì•ˆì„±ì‹œ': ['41550'], 'ê¹€í¬ì‹œ': ['41570'], 'í™”ì„±ì‹œ': ['41590'], 'ê´‘ì£¼ì‹œ': ['41610'], 'ì–‘ì£¼ì‹œ': ['41630'],
        'í¬ì²œì‹œ': ['41650'], 'ì—¬ì£¼ì‹œ': ['41670'], 'ì—°ì²œêµ°': ['41800'], 'ê°€í‰êµ°': ['41820'], 'ì–‘í‰êµ°': ['41830']
    },
    'ê°•ì›íŠ¹ë³„ìì¹˜ë„': {
        'ì „ì²´': ['42110', '42130', '42150', '42170', '42190', '42210', '42230', '42720', '42730', '42750', '42760', '42770', '42780', '42790', '42800', '42810', '42820', '42830'],
        'ì¶˜ì²œì‹œ': ['42110'], 'ì›ì£¼ì‹œ': ['42130'], 'ê°•ë¦‰ì‹œ': ['42150'], 'ë™í•´ì‹œ': ['42170'], 'íƒœë°±ì‹œ': ['42190'],
        'ì†ì´ˆì‹œ': ['42210'], 'ì‚¼ì²™ì‹œ': ['42230'], 'í™ì²œêµ°': ['42720'], 'íš¡ì„±êµ°': ['42730'], 'ì˜ì›”êµ°': ['42750'],
        'í‰ì°½êµ°': ['42760'], 'ì •ì„ êµ°': ['42770'], 'ì² ì›êµ°': ['42780'], 'í™”ì²œêµ°': ['42790'], 'ì–‘êµ¬êµ°': ['42800'],
        'ì¸ì œêµ°': ['42810'], 'ê³ ì„±êµ°': ['42820'], 'ì–‘ì–‘êµ°': ['42830']
    },
    'ì¶©ì²­ë¶ë„': {
        'ì „ì²´': ['43111', '43112', '43113', '43114', '43130', '43150', '43720', '43730', '43740', '43745', '43750', '43760', '43770', '43800'],
        'ì²­ì£¼ì‹œ': ['43111', '43112', '43113', '43114'], 'ì¶©ì£¼ì‹œ': ['43130'], 'ì œì²œì‹œ': ['43150'],
        'ë³´ì€êµ°': ['43720'], 'ì˜¥ì²œêµ°': ['43730'], 'ì˜ë™êµ°': ['43740'], 'ì¦í‰êµ°': ['43745'], 'ì§„ì²œêµ°': ['43750'],
        'ê´´ì‚°êµ°': ['43760'], 'ìŒì„±êµ°': ['43770'], 'ë‹¨ì–‘êµ°': ['43800']
    },
    'ì¶©ì²­ë‚¨ë„': {
        'ì „ì²´': ['44131', '44133', '44150', '44180', '44200', '44210', '44230', '44250', '44270', '44710', '44760', '44770', '44790', '44800', '44810', '44825'],
        'ì²œì•ˆì‹œ': ['44131', '44133'], 'ê³µì£¼ì‹œ': ['44150'], 'ë³´ë ¹ì‹œ': ['44180'], 'ì•„ì‚°ì‹œ': ['44200'], 'ì„œì‚°ì‹œ': ['44210'],
        'ë…¼ì‚°ì‹œ': ['44230'], 'ê³„ë£¡ì‹œ': ['44250'], 'ë‹¹ì§„ì‹œ': ['44270'], 'ê¸ˆì‚°êµ°': ['44710'], 'ë¶€ì—¬êµ°': ['44760'],
        'ì„œì²œêµ°': ['44770'], 'ì²­ì–‘êµ°': ['44790'], 'í™ì„±êµ°': ['44800'], 'ì˜ˆì‚°êµ°': ['44810'], 'íƒœì•ˆêµ°': ['44825']
    },
    'ì „ë¼ë¶ë„': {
        'ì „ì²´': ['45111', '45113', '45130', '45140', '45180', '45190', '45210', '45710', '45720', '45730', '45740', '45750', '45770', '45790', '45800'],
        'ì „ì£¼ì‹œ': ['45111', '45113'], 'êµ°ì‚°ì‹œ': ['45130'], 'ìµì‚°ì‹œ': ['45140'], 'ì •ìì‹œ': ['45180'], 'ë‚¨ì›ì‹œ': ['45190'],
        'ê¹€ì œì‹œ': ['45210'], 'ì™„ì£¼êµ°': ['45710'], 'ì§„ì•ˆêµ°': ['45720'], 'ë¬´ì£¼êµ°': ['45730'], 'ì¥ìˆ˜êµ°': ['45740'],
        'ì„ì‹¤êµ°': ['45750'], 'ìˆœì°½êµ°': ['45770'], 'ê³ ì°½êµ°': ['45790'], 'ë¶€ì•ˆêµ°': ['45800']
    },
    'ì „ë¼ë‚¨ë„': {
        'ì „ì²´': ['46110', '46130', '46150', '46170', '46230', '46710', '46720', '46730', '46770', '46780', '46790', '46800', '46810', '46820', '46830', '46840', '46860', '46870', '46880', '46890', '46900', '46910'],
        'ëª©í¬ì‹œ': ['46110'], 'ì—¬ìˆ˜ì‹œ': ['46130'], 'ìˆœì²œì‹œ': ['46150'], 'ë‚˜ì£¼ì‹œ': ['46170'], 'ê´‘ì–‘ì‹œ': ['46230'],
        'ë‹´ì–‘êµ°': ['46710'], 'ê³¡ì„±êµ°': ['46720'], 'êµ¬ë¡€êµ°': ['46730'], 'ê³ í¥êµ°': ['46770'], 'ë³´ì„±êµ°': ['46780'],
        'í™”ìˆœêµ°': ['46790'], 'ì¥í¥êµ°': ['46800'], 'ê°•ì§„êµ°': ['46810'], 'í•´ë‚¨êµ°': ['46820'], 'ì˜ì•”êµ°': ['46830'],
        'ë¬´ì•ˆêµ°': ['46840'], 'í•¨í‰êµ°': ['46860'], 'ì˜ê´‘êµ°': ['46870'], 'ì¥ì„±êµ°': ['46880'], 'ì™„ë„êµ°': ['46890'],
        'ì§„ë„êµ°': ['46900'], 'ì‹ ì•ˆêµ°': ['46910']
    },
    'ê²½ìƒë¶ë„': {
        'ì „ì²´': ['47111', '47113', '47130', '47150', '47170', '47190', '47210', '47230', '47250', '47280', '47290', '47720', '47730', '47750', '47760', '47770', '47820', '47830', '47840', '47850', '47900', '47920', '47930', '47940'],
        'í¬í•­ì‹œ': ['47111', '47113'], 'ê²½ì£¼ì‹œ': ['47130'], 'ê¹€ì²œì‹œ': ['47150'], 'ì•ˆë™ì‹œ': ['47170'], 'êµ¬ë¯¸ì‹œ': ['47190'],
        'ì˜ì£¼ì‹œ': ['47210'], 'ì˜ì²œì‹œ': ['47230'], 'ìƒì£¼ì‹œ': ['47250'], 'ë¬¸ê²½ì‹œ': ['47280'], 'ê²½ì‚°ì‹œ': ['47290'],
        'êµ°ìœ„êµ°': ['47720'], 'ì˜ì„±êµ°': ['47730'], 'ì²­ì†¡êµ°': ['47750'], 'ì˜ì–‘êµ°': ['47760'], 'ì˜ë•êµ°': ['47770'],
        'ì²­ë„êµ°': ['47820'], 'ê³ ë ¹êµ°': ['47830'], 'ì„±ì£¼êµ°': ['47840'], 'ì¹ ê³¡êµ°': ['47850'], 'ì˜ˆì²œêµ°': ['47900'],
        'ë´‰í™”êµ°': ['47920'], 'ìš¸ì§„êµ°': ['47930'], 'ìš¸ë¦‰êµ°': ['47940']
    },
    'ê²½ìƒë‚¨ë„': {
        'ì „ì²´': ['48121', '48123', '48125', '48127', '48129', '48170', '48220', '48240', '48250', '48270', '48310', '48330', '48720', '48730', '48740', '48820', '48840', '48850', '48860', '48870', '48880', '48890'],
        'ì°½ì›ì‹œ': ['48121', '48123', '48125', '48127', '48129'], 'ì§„ì£¼ì‹œ': ['48170'], 'í†µì˜ì‹œ': ['48220'], 'ì‚¬ì²œì‹œ': ['48240'],
        'ê¹€í•´ì‹œ': ['48250'], 'ë°€ì–‘ì‹œ': ['48270'], 'ê±°ì œì‹œ': ['48310'], 'ì–‘ì‚°ì‹œ': ['48330'], 'ì˜ë ¹êµ°': ['48720'],
        'í•¨ì•ˆêµ°': ['48730'], 'ì°½ë…•êµ°': ['48740'], 'ê³ ì„±êµ°': ['48820'], 'ë‚¨í•´êµ°': ['48840'], 'í•˜ë™êµ°': ['48850'],
        'ì‚°ì²­êµ°': ['48860'], 'í•¨ì–‘êµ°': ['48870'], 'ê±°ì°½êµ°': ['48880'], 'í•©ì²œêµ°': ['48890']
    },
    'ì œì£¼íŠ¹ë³„ìì¹˜ë„': {
        'ì „ì²´': ['50110', '50130'],
        'ì œì£¼ì‹œ': ['50110'], 'ì„œê·€í¬ì‹œ': ['50130']
    }
}

class MOLITAPIClient:
    """êµ­í† ë¶€ ì‹¤ê±°ë˜ê°€ API í´ë¼ì´ì–¸íŠ¸"""
    
    def __init__(self, api_key):
        self.api_key = api_key
        self.base_url = "http://openapi.molit.go.kr:8081/OpenAPI_ToolInstallPackage/service/rest/RTMSOBJSvc/getRTMSDataSvcAptTradeDev"
    
    def fetch_apt_trade(self, lawd_cd, deal_ymd):
        """ì•„íŒŒíŠ¸ ì‹¤ê±°ë˜ê°€ ì¡°íšŒ"""
        params = {
            'serviceKey': self.api_key,
            'LAWD_CD': lawd_cd,
            'DEAL_YMD': deal_ymd,
            'numOfRows': '1000'
        }
        
        try:
            response = requests.get(self.base_url, params=params, timeout=30)
            
            if response.status_code == 200:
                return self.parse_xml(response.content)
            else:
                return []
        except Exception as e:
            return []
    
    def parse_xml(self, xml_content):
        """XML íŒŒì‹±"""
        try:
            root = ET.fromstring(xml_content)
            
            # ê²°ê³¼ ì½”ë“œ í™•ì¸
            result_code = root.findtext('.//resultCode')
            if result_code != '00':
                return []
            
            items = []
            for item in root.findall('.//item'):
                try:
                    # ê±°ë˜ê¸ˆì•¡ ì „ì²˜ë¦¬ (ê³µë°±, ì‰¼í‘œ ì œê±°)
                    price_str = item.findtext('ê±°ë˜ê¸ˆì•¡', '0').strip().replace(',', '')
                    
                    data = {
                        'ì§€ì—­ì½”ë“œ': item.findtext('ì§€ì—­ì½”ë“œ'),
                        'ì‹œêµ°êµ¬': item.findtext('ë²•ì •ë™'),
                        'ì•„íŒŒíŠ¸': item.findtext('ì•„íŒŒíŠ¸'),
                        'ê±°ë˜ê¸ˆì•¡': int(price_str) if price_str.isdigit() else 0,
                        'ê±´ì¶•ë…„ë„': int(item.findtext('ê±´ì¶•ë…„ë„', '0')),
                        'ë…„': int(item.findtext('ë…„', '0')),
                        'ì›”': int(item.findtext('ì›”', '0')),
                        'ì¼': int(item.findtext('ì¼', '0')),
                        'ì „ìš©ë©´ì ': float(item.findtext('ì „ìš©ë©´ì ', '0')),
                        'ì¸µ': int(item.findtext('ì¸µ', '0')) if item.findtext('ì¸µ', '0').replace('-','').isdigit() else 0,
                        'ë„ë¡œëª…': item.findtext('ë„ë¡œëª…'),
                        'í•´ì œì‚¬ìœ ë°œìƒì¼': item.findtext('í•´ì œì‚¬ìœ ë°œìƒì¼'),
                        'ê±°ë˜ìœ í˜•': item.findtext('ê±°ë˜ìœ í˜•', 'ì§ê±°ë˜'),
                    }
                    items.append(data)
                except Exception as e:
                    continue
            
            return items
            
        except ET.ParseError as e:
            return []

def analyze_anomalies(df):
    """ì´ìƒê±°ë˜ ë¶„ì„"""
    if df.empty:
        return df
    
    df = df.copy()
    
    # í‰ìˆ˜ ê³„ì‚°
    df['í‰ìˆ˜'] = (df['ì „ìš©ë©´ì '] * 0.3025).round(1)
    
    # í‰ë‹¹ê°€ ê³„ì‚°
    df['í‰ë‹¹ê°€'] = (df['ê±°ë˜ê¸ˆì•¡'] / df['í‰ìˆ˜']).round(0)
    
    # ë‹¨ì§€ë³„ í‰ê·  ê³„ì‚°
    df['ë‹¨ì§€í‰ê· ê°€'] = df.groupby(['ì•„íŒŒíŠ¸', 'ì „ìš©ë©´ì '])['ê±°ë˜ê¸ˆì•¡'].transform('mean')
    df['ë‹¨ì§€í‰ê· í‰ë‹¹ê°€'] = df.groupby(['ì•„íŒŒíŠ¸', 'ì „ìš©ë©´ì '])['í‰ë‹¹ê°€'].transform('mean')
    
    # ê°€ê²© í¸ì°¨ìœ¨
    df['ê°€ê²©í¸ì°¨ìœ¨'] = ((df['ê±°ë˜ê¸ˆì•¡'] - df['ë‹¨ì§€í‰ê· ê°€']) / df['ë‹¨ì§€í‰ê· ê°€'] * 100).round(1)
    
    # í‰ë‹¹ê°€ í¸ì°¨ìœ¨
    df['í‰ë‹¹ê°€í¸ì°¨ìœ¨'] = ((df['í‰ë‹¹ê°€'] - df['ë‹¨ì§€í‰ê· í‰ë‹¹ê°€']) / df['ë‹¨ì§€í‰ê· í‰ë‹¹ê°€'] * 100).round(1)
    
    # ì´ìƒ ì‹ í˜¸ ì ìˆ˜ ê³„ì‚°
    def calculate_anomaly_score(row):
        score = 0
        reasons = []
        
        # 1. ê¸‰ê²©í•œ ê°€ê²© ìƒìŠ¹ (30% ì´ìƒ)
        if row['ê°€ê²©í¸ì°¨ìœ¨'] > 30:
            score += 40
            reasons.append('ê¸‰ê²©í•œ ê°€ê²© ìƒìŠ¹')
        elif row['ê°€ê²©í¸ì°¨ìœ¨'] > 20:
            score += 25
            reasons.append('ê°€ê²© ìƒìŠ¹')
        
        # 2. ê¸‰ê²©í•œ ê°€ê²© í•˜ë½ (20% ì´ìƒ)
        if row['ê°€ê²©í¸ì°¨ìœ¨'] < -20:
            score += 35
            reasons.append('ê¸‰ê²©í•œ ê°€ê²© í•˜ë½')
        elif row['ê°€ê²©í¸ì°¨ìœ¨'] < -15:
            score += 20
            reasons.append('ê°€ê²© í•˜ë½')
        
        # 3. í‰ë‹¹ê°€ ì´ìƒ
        if abs(row['í‰ë‹¹ê°€í¸ì°¨ìœ¨']) > 25:
            score += 20
            reasons.append('í‰ë‹¹ê°€ ì´ìƒ')
        
        # 4. ì €ì¸µ ê³ ê°€ (5ì¸µ ì´í•˜ì¸ë° í‰ê· ë³´ë‹¤ ë†’ìŒ)
        if row['ì¸µ'] <= 5 and row['ê°€ê²©í¸ì°¨ìœ¨'] > 10:
            score += 15
            reasons.append('ì €ì¸µ ê³ ê°€')
        
        # 5. í•´ì œì‚¬ìœ  ìˆìŒ
        if pd.notna(row['í•´ì œì‚¬ìœ ë°œìƒì¼']) and row['í•´ì œì‚¬ìœ ë°œìƒì¼'] != '':
            score += 30
            reasons.append('ê±°ë˜ í•´ì œ ì´ë ¥')
        
        # 6. ì´ˆê³ ì¸µ ì €ê°€ (20ì¸µ ì´ìƒì¸ë° í‰ê· ë³´ë‹¤ ë‚®ìŒ)
        if row['ì¸µ'] >= 20 and row['ê°€ê²©í¸ì°¨ìœ¨'] < -10:
            score += 10
            reasons.append('ê³ ì¸µ ì €ê°€')
        
        return score, reasons
    
    df[['ì´ìƒì ìˆ˜', 'ì´ìƒì‚¬ìœ ']] = df.apply(
        lambda row: pd.Series(calculate_anomaly_score(row)), 
        axis=1
    )
    
    # ì´ìƒê±°ë˜ ì—¬ë¶€
    df['ì´ìƒê±°ë˜'] = df['ì´ìƒì ìˆ˜'] >= 20
    
    return df

def main():
    st.title("ğŸ  ì „êµ­ ì‹¤ê±°ë˜ê°€ ì´ìƒê±°ë˜ íƒì§€ ì‹œìŠ¤í…œ")
    st.markdown("**êµ­í† ë¶€ ì‹¤ê±°ë˜ê°€ Open API ì‹¤ì‹œê°„ ì—°ë™ (ì „êµ­ 17ê°œ ì‹œë„)**")
    st.markdown("---")
    
    # ì‚¬ì´ë“œë°” - API ì„¤ì •
    with st.sidebar:
        st.header("âš™ï¸ API ì„¤ì •")
        
        # API í‚¤ ì…ë ¥
        api_key = st.text_input(
            "êµ­í† ë¶€ API ì¸ì¦í‚¤",
            type="password",
            help="ê³µê³µë°ì´í„°í¬í„¸(data.go.kr)ì—ì„œ ë°œê¸‰ë°›ì€ ì¸ì¦í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”"
        )
        
        if not api_key:
            st.warning("âš ï¸ API ì¸ì¦í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”")
            st.markdown("""
            **API í‚¤ ë°œê¸‰ ë°©ë²•:**
            1. [ê³µê³µë°ì´í„°í¬í„¸](https://www.data.go.kr) ì ‘ì†
            2. íšŒì›ê°€ì… ë° ë¡œê·¸ì¸
            3. 'ì•„íŒŒíŠ¸ë§¤ë§¤ ì‹¤ê±°ë˜ ìƒì„¸ ìë£Œ' ê²€ìƒ‰
            4. í™œìš©ì‹ ì²­ â†’ ì¸ì¦í‚¤ ë°œê¸‰
            5. ìŠ¹ì¸ê¹Œì§€ 1-2ì‹œê°„ ì†Œìš”
            """)
        
        st.markdown("---")
        
        # ê²€ìƒ‰ ì¡°ê±´
        st.header("ğŸ” ê²€ìƒ‰ ì¡°ê±´")
        
        # ì‹œë„ ì„ íƒ
        selected_sido = st.selectbox(
            "ì‹œ/ë„ ì„ íƒ",
            list(REGION_CODES.keys())
        )
        
        # ì‹œêµ°êµ¬ ì„ íƒ
        sigungu_options = list(REGION_CODES[selected_sido].keys())
        selected_sigungu = st.selectbox(
            "ì‹œ/êµ°/êµ¬ ì„ íƒ",
            sigungu_options
        )
        
        # ê¸°ê°„ ì„ íƒ
        search_date = st.date_input(
            "ì¡°íšŒ ë…„ì›”",
            value=datetime.now() - timedelta(days=30),
            max_value=datetime.now()
        )
        
        deal_ymd = search_date.strftime('%Y%m')
        
        # ì´ìƒê±°ë˜ ì„ê³„ê°’
        st.markdown("---")
        st.subheader("ğŸ“Š íƒì§€ ì„¤ì •")
        min_score = st.slider(
            "ìµœì†Œ ì´ìƒì ìˆ˜",
            min_value=10,
            max_value=50,
            value=20,
            step=5,
            help="ì´ ì ìˆ˜ ì´ìƒì¸ ê±°ë˜ë§Œ í‘œì‹œ"
        )
        
        # ìµœëŒ€ ì¡°íšŒ ê±´ìˆ˜
        max_codes = st.slider(
            "ìµœëŒ€ ì¡°íšŒ ì§€ì—­ ìˆ˜",
            min_value=1,
            max_value=50,
            value=10,
            help="'ì „ì²´' ì„ íƒ ì‹œ ì¡°íšŒí•  ìµœëŒ€ ì§€ì—­ ìˆ˜ (API ì œí•œ ê³ ë ¤)"
        )
        
        # ë°ì´í„° ì¡°íšŒ ë²„íŠ¼
        st.markdown("---")
        search_button = st.button("ğŸ” ë°ì´í„° ì¡°íšŒ", type="primary", use_container_width=True)
        
        # ì•ˆë‚´
        if selected_sigungu == 'ì „ì²´':
            st.info(f"ğŸ’¡ '{selected_sido}' ì „ì²´ ì§€ì—­ì„ ì¡°íšŒí•©ë‹ˆë‹¤. ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
    
    # API í‚¤ê°€ ì—†ìœ¼ë©´ ì•ˆë‚´ í‘œì‹œ
    if not api_key:
        st.info("ğŸ‘ˆ ì™¼ìª½ ì‚¬ì´ë“œë°”ì—ì„œ API ì¸ì¦í‚¤ë¥¼ ì…ë ¥í•˜ê³  ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ì„¸ìš”")
        
        # ì§€ì› ì§€ì—­ ì•ˆë‚´
        st.subheader("ğŸ“ ì§€ì› ì§€ì—­")
        cols = st.columns(3)
        for idx, sido in enumerate(list(REGION_CODES.keys())):
            with cols[idx % 3]:
                st.write(f"âœ… **{sido}**")
                st.caption(f"{len(REGION_CODES[sido])-1}ê°œ ì‹œêµ°êµ¬")
        
        return
    
    # ë°ì´í„° ì¡°íšŒ
    if search_button:
        with st.spinner(f'ğŸ”„ {selected_sido} {selected_sigungu} ì‹¤ê±°ë˜ê°€ ë°ì´í„° ì¡°íšŒ ì¤‘...'):
            client = MOLITAPIClient(api_key)
            
            all_data = []
            region_codes = REGION_CODES[selected_sido][selected_sigungu]
            
            # ì „ì²´ ì„ íƒ ì‹œ ìµœëŒ€ ì¡°íšŒ ìˆ˜ ì œí•œ
            if selected_sigungu == 'ì „ì²´' and len(region_codes) > max_codes:
                region_codes = region_codes[:max_codes]
                st.warning(f"âš ï¸ API ì œí•œìœ¼ë¡œ ì¸í•´ {max_codes}ê°œ ì§€ì—­ë§Œ ì¡°íšŒí•©ë‹ˆë‹¤.")
            
            progress_bar = st.progress(0)
            status_text = st.empty()
            
            for idx, code in enumerate(region_codes):
                status_text.text(f"ì§€ì—­ì½”ë“œ {code} ì¡°íšŒ ì¤‘... ({idx+1}/{len(region_codes)})")
                
                data = client.fetch_apt_trade(code, deal_ymd)
                all_data.extend(data)
                
                progress_bar.progress((idx + 1) / len(region_codes))
                time.sleep(0.3)  # API ìš”ì²­ ê°„ê²©
            
            progress_bar.empty()
            status_text.empty()
            
            if not all_data:
                st.warning("âš ï¸ ì¡°íšŒëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. API í‚¤ì™€ ì¡°íšŒ ì¡°ê±´ì„ í™•ì¸í•´ì£¼ì„¸ìš”.")
                return
            
            # ë°ì´í„°í”„ë ˆì„ ìƒì„±
            df = pd.DataFrame(all_data)
            
            # ì´ìƒê±°ë˜ ë¶„ì„
            with st.spinner('ğŸ“Š ì´ìƒê±°ë˜ ë¶„ì„ ì¤‘...'):
                df_analyzed = analyze_anomalies(df)
            
            # ì„¸ì…˜ì— ì €ì¥
            st.session_state['df_analyzed'] = df_analyzed
            st.session_state['search_region'] = f"{selected_sido} {selected_sigungu}"
            st.session_state['search_date'] = deal_ymd
            
            st.success(f"âœ… ì´ {len(df):,} ê±´ì˜ ì‹¤ê±°ë˜ ë°ì´í„°ë¥¼ ì¡°íšŒí–ˆìŠµë‹ˆë‹¤!")
    
    # ë¶„ì„ ê²°ê³¼ í‘œì‹œ
    if 'df_analyzed' in st.session_state:
        df_analyzed = st.session_state['df_analyzed']
        
        # í•„í„°ë§
        df_filtered = df_analyzed[df_analyzed['ì´ìƒì ìˆ˜'] >= min_score].copy()
        df_filtered = df_filtered.sort_values('ì´ìƒì ìˆ˜', ascending=False)
        
        # í†µê³„ ì¹´ë“œ
        col1, col2, col3, col4 = st.columns(4)
        
        with col1:
            st.metric("ì „ì²´ ê±°ë˜", f"{len(df_analyzed):,}ê±´")
        
        with col2:
            anomaly_count = df_analyzed['ì´ìƒê±°ë˜'].sum()
            anomaly_rate = (anomaly_count / len(df_analyzed) * 100) if len(df_analyzed) > 0 else 0
            st.metric("ì´ìƒê±°ë˜", f"{anomaly_count:,}ê±´", f"{anomaly_rate:.1f}%")
        
        with col3:
            high_price = (df_analyzed['ê°€ê²©í¸ì°¨ìœ¨'] > 20).sum()
            st.metric("ê¸‰ë“± ì˜ì‹¬", f"{high_price:,}ê±´")
        
        with col4:
            low_price = (df_analyzed['ê°€ê²©í¸ì°¨ìœ¨'] < -20).sum()
            st.metric("ê¸‰ë½ ì˜ì‹¬", f"{low_price:,}ê±´")
        
        st.markdown("---")
        
        # ì§€ì—­ ì •ë³´ í‘œì‹œ
        st.info(f"ğŸ“ **ì¡°íšŒ ì§€ì—­**: {st.session_state['search_region']} | **ì¡°íšŒ ê¸°ê°„**: {st.session_state['search_date']}")
        
        # ìƒìœ„ ì´ìƒê±°ë˜ TOP 10
        st.subheader("ğŸ† ì´ìƒì ìˆ˜ TOP 10")
        top_10 = df_filtered.head(10)
        
        if len(top_10) > 0:
            for idx, row in top_10.iterrows():
                col1, col2, col3, col4 = st.columns([1, 3, 2, 2])
                
                with col1:
                    if row['ì´ìƒì ìˆ˜'] >= 40:
                        st.error(f"**{row['ì´ìƒì ìˆ˜']}ì **")
                    elif row['ì´ìƒì ìˆ˜'] >= 25:
                        st.warning(f"**{row['ì´ìƒì ìˆ˜']}ì **")
                    else:
                        st.info(f"**{row['ì´ìƒì ìˆ˜']}ì **")
                
                with col2:
                    st.write(f"**{row['ì•„íŒŒíŠ¸']}**")
                    st.caption(f"{row['ì‹œêµ°êµ¬']}")
                
                with col3:
                    st.write(f"{row['ê±°ë˜ê¸ˆì•¡']:,}ë§Œì›")
                    st.caption(f"{row['ì „ìš©ë©´ì ']:.1f}ã¡ ({row['í‰ìˆ˜']:.1f}í‰)")
                
                with col4:
                    if row['ê°€ê²©í¸ì°¨ìœ¨'] > 0:
                        st.write(f"ğŸ”º +{row['ê°€ê²©í¸ì°¨ìœ¨']:.1f}%")
                    else:
                        st.write(f"ğŸ”» {row['ê°€ê²©í¸ì°¨ìœ¨']:.1f}%")
                    st.caption(' / '.join(row['ì´ìƒì‚¬ìœ '][:2]))
        else:
            st.info("ì¡°ê±´ì— ë§ëŠ” ì´ìƒê±°ë˜ê°€ ì—†ìŠµë‹ˆë‹¤.")
        
        st.markdown("---")
        
        # ì´ìƒê±°ë˜ ëª©ë¡
        st.subheader(f"ğŸš¨ ì´ìƒê±°ë˜ íƒì§€ ê²°ê³¼ ({len(df_filtered):,}ê±´)")
        
        # í•„í„° ì˜µì…˜
        col1, col2, col3 = st.columns(3)
        
        with col1:
            filter_anomaly_type = st.selectbox(
                "ì´ìƒ ìœ í˜•",
                ['ì „ì²´', 'ê¸‰ë“± ì˜ì‹¬', 'ê¸‰ë½ ì˜ì‹¬', 'í•´ì œ ì´ë ¥']
            )
        
        with col2:
            min_price = st.number_input(
                "ìµœì†Œ ê±°ë˜ê¸ˆì•¡ (ë§Œì›)",
                min_value=0,
                value=0,
                step=1000
            )
        
        with col3:
            min_area = st.number_input(
                "ìµœì†Œ ë©´ì  (ã¡)",
                min_value=0.0,
                value=0.0,
                step=10.0
            )
        
        # ì¶”ê°€ í•„í„°ë§
        if filter_anomaly_type == 'ê¸‰ë“± ì˜ì‹¬':
            df_filtered = df_filtered[df_filtered['ê°€ê²©í¸ì°¨ìœ¨'] > 20]
        elif filter_anomaly_type == 'ê¸‰ë½ ì˜ì‹¬':
            df_filtered = df_filtered[df_filtered['ê°€ê²©í¸ì°¨ìœ¨'] < -20]
        elif filter_anomaly_type == 'í•´ì œ ì´ë ¥':
            df_filtered = df_filtered[pd.notna(df_filtered['í•´ì œì‚¬ìœ ë°œìƒì¼']) & (df_filtered['í•´ì œì‚¬ìœ ë°œìƒì¼'] != '')]
        
        if min_price > 0:
            df_filtered = df_filtered[df_filtered['ê±°ë˜ê¸ˆì•¡'] >= min_price]
        
        if min_area > 0:
            df_filtered = df_filtered[df_filtered['ì „ìš©ë©´ì '] >= min_area]
        
        st.write(f"**í•„í„°ë§ ê²°ê³¼: {len(df_filtered):,}ê±´**")
        
        if len(df_filtered) == 0:
            st.info("ì¡°ê±´ì— ë§ëŠ” ì´ìƒê±°ë˜ê°€ ì—†ìŠµë‹ˆë‹¤. í•„í„° ì¡°ê±´ì„ ë³€ê²½í•´ë³´ì„¸ìš”.")
        else:
            # í˜ì´ì§€ë„¤ì´ì…˜
            items_per_page = 20
            total_pages = (len(df_filtered) - 1) // items_per_page + 1
            
            page = st.selectbox(
                f"í˜ì´ì§€ ì„ íƒ (ì´ {total_pages}í˜ì´ì§€)",
                range(1, total_pages + 1)
            )
            
            start_idx = (page - 1) * items_per_page
            end_idx = min(start_idx + items_per_page, len(df_filtered))
            
            df_page = df_filtered.iloc[start_idx:end_idx]
            
            for idx, row in df_page.iterrows():
                # ìœ„í—˜ë„ì— ë”°ë¥¸ ìƒ‰ìƒ
                if row['ì´ìƒì ìˆ˜'] >= 40:
                    color = "ğŸ”´"
                elif row['ì´ìƒì ìˆ˜'] >= 25:
                    color = "ğŸŸ "
                else:
                    color = "ğŸŸ¡"
                
                with st.expander(
                    f"{color} **{row['ì•„íŒŒíŠ¸']}** | {row['ì‹œêµ°êµ¬']} | "
                    f"ì ìˆ˜: {row['ì´ìƒì ìˆ˜']}ì  | í¸ì°¨: {row['ê°€ê²©í¸ì°¨ìœ¨']:+.1f}%"
                ):
                    col1, col2, col3 = st.columns(3)
                    
                    with col1:
                        st.markdown("**ğŸ“ ê¸°ë³¸ ì •ë³´**")
                        st.write(f"- ì§€ì—­: {row['ì‹œêµ°êµ¬']}")
                        st.write(f"- ë‹¨ì§€: {row['ì•„íŒŒíŠ¸']}")
                        st.write(f"- ì¸µ: {row['ì¸µ']}ì¸µ")
                        st.write(f"- ê±´ì¶•ë…„ë„: {row['ê±´ì¶•ë…„ë„']}ë…„")
                        st.write(f"- ì „ìš©ë©´ì : {row['ì „ìš©ë©´ì ']:.2f}ã¡ ({row['í‰ìˆ˜']:.1f}í‰)")
                        if row['ë„ë¡œëª…']:
                            st.write(f"- ë„ë¡œëª…: {row['ë„ë¡œëª…']}")
                    
                    with col2:
                        st.markdown("**ğŸ’° ê°€ê²© ì •ë³´**")
                        st.write(f"- ê±°ë˜ê¸ˆì•¡: **{row['ê±°ë˜ê¸ˆì•¡']:,}ë§Œì›**")
                        st.write(f"- ë‹¨ì§€í‰ê· : {row['ë‹¨ì§€í‰ê· ê°€']:,.0f}ë§Œì›")
                        st.write(f"- ê°€ê²©í¸ì°¨: **{row['ê°€ê²©í¸ì°¨ìœ¨']:+.1f}%**")
                        st.write(f"- í‰ë‹¹ê°€: {row['í‰ë‹¹ê°€']:,.0f}ë§Œì›")
                        st.write(f"- í‰ê· í‰ë‹¹ê°€: {row['ë‹¨ì§€í‰ê· í‰ë‹¹ê°€']:,.0f}ë§Œì›")
                        st.write(f"- ê±°ë˜ìœ í˜•: {row['ê±°ë˜ìœ í˜•']}")
                    
                    with col3:
                        st.markdown("**ğŸ” ì´ìƒ ë¶„ì„**")
                        st.write(f"- ì´ìƒì ìˆ˜: **{row['ì´ìƒì ìˆ˜']}ì **")
                        st.write(f"- ê±°ë˜ì¼: {row['ë…„']}-{row['ì›”']:02d}-{row['ì¼']:02d}")
                        
                        if row['ì´ìƒì‚¬ìœ ']:
                            st.write("- ì´ìƒì‚¬ìœ :")
                            for reason in row['ì´ìƒì‚¬ìœ ']:
                                st.write(f"  â€¢ {reason}")
                        
                        if pd.notna(row['í•´ì œì‚¬ìœ ë°œìƒì¼']) and row['í•´ì œì‚¬ìœ ë°œìƒì¼'] != '':
                            st.error(f"âš ï¸ ê±°ë˜ í•´ì œ: {row['í•´ì œì‚¬ìœ ë°œìƒì¼']}")
        
        st.markdown("---")
        
        # í†µê³„ ë¶„ì„
        st.subheader("ğŸ“Š í†µê³„ ë¶„ì„")
        
        tab1, tab2, tab3 = st.tabs(["ì§€ì—­ë³„ ë¶„ì„", "ê°€ê²©ëŒ€ë³„ ë¶„ì„", "ë©´ì ë³„ ë¶„ì„"])
        
        with tab1:
            # ì§€ì—­ë³„ ì´ìƒê±°ë˜ ê±´ìˆ˜
            region_stats = df_analyzed[df_analyzed['ì´ìƒê±°ë˜']].groupby('ì‹œêµ°êµ¬').size().sort_values(ascending=False).head(10)
            
            if len(region_stats) > 0:
                st.write("**ì´ìƒê±°ë˜ê°€ ë§ì€ ì§€ì—­ TOP 10**")
                for region, count in region_stats.items():
                    st.write(f"- {region}: {count}ê±´")
            else:
                st.info("ì´ìƒê±°ë˜ê°€ íƒì§€ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.")
        
        with tab2:
            # ê°€ê²©ëŒ€ë³„ ë¶„ì„
            df_analyzed['ê°€ê²©ëŒ€'] = pd.cut(
                df_analyzed['ê±°ë˜ê¸ˆì•¡'],
                bins=[0, 30000, 50000, 70000, 100000, float('inf')],
                labels=['3ì–µ ì´í•˜', '3~5ì–µ', '5~7ì–µ', '7~10ì–µ', '10ì–µ ì´ìƒ']
            )
            
            price_stats = df_analyzed[df_analyzed['ì´ìƒê±°ë˜']].groupby('ê°€ê²©ëŒ€').size()
            
            st.write("**ê°€ê²©ëŒ€ë³„ ì´ìƒê±°ë˜ ë¶„í¬**")
            for price_range, count in price_stats.items():
                st.write(f"- {price_range}: {count}ê±´")
        
        with tab3:
            # ë©´ì ë³„ ë¶„ì„
            df_analyzed['ë©´ì ëŒ€'] = pd.cut(
                df_analyzed['ì „ìš©ë©´ì '],
                bins=[0, 60, 85, 100, 135, float('inf')],
                labels=['ì†Œí˜• (60ã¡ ì´í•˜)', 'ì¤‘ì†Œí˜• (60~85ã¡)', 'ì¤‘í˜• (85~100ã¡)', 'ì¤‘ëŒ€í˜• (100~135ã¡)', 'ëŒ€í˜• (135ã¡ ì´ìƒ)']
            )
            
            area_stats = df_analyzed[df_analyzed['ì´ìƒê±°ë˜']].groupby('ë©´ì ëŒ€').size()
            
            st.write("**ë©´ì ëŒ€ë³„ ì´ìƒê±°ë˜ ë¶„í¬**")
            for area_range, count in area_stats.items():
                st.write(f"- {area_range}: {count}ê±´")
        
        st.markdown("---")
        
        # ë°ì´í„° ë‹¤ìš´ë¡œë“œ
        st.subheader("ğŸ“¥ ë°ì´í„° ë‹¤ìš´ë¡œë“œ")
        
        col1, col2 = st.columns(2)
        
        with col1:
            # ì „ì²´ ë°ì´í„°
            csv_all = df_analyzed.to_csv(index=False, encoding='utf-8-sig')
            st.download_button(
                label="ğŸ“Š ì „ì²´ ë°ì´í„° ë‹¤ìš´ë¡œë“œ (CSV)",
                data=csv_all,
                file_name=f"trade_all_{st.session_state['search_date']}.csv",
                mime="text/csv",
                use_container_width=True
            )
        
        with col2:
            # ì´ìƒê±°ë˜ë§Œ
            csv_anomaly = df_filtered.to_csv(index=False, encoding='utf-8-sig')
            st.download_button(
                label="ğŸš¨ ì´ìƒê±°ë˜ë§Œ ë‹¤ìš´ë¡œë“œ (CSV)",
                data=csv_anomaly,
                file_name=f"trade_anomaly_{st.session_state['search_date']}.csv",
                mime="text/csv",
                use_container_width=True
            )
        
        # ì•ˆë‚´ ì •ë³´
        st.markdown("---")
        st.info("""
        **ğŸ“Œ ì´ìƒê±°ë˜ íƒì§€ ì•Œê³ ë¦¬ì¦˜**
        - **ê¸‰ê²©í•œ ê°€ê²© ìƒìŠ¹**: ë‹¨ì§€ í‰ê·  ëŒ€ë¹„ 30% ì´ìƒ ë†’ì€ ê±°ë˜ (40ì )
        - **ê¸‰ê²©í•œ ê°€ê²© í•˜ë½**: ë‹¨ì§€ í‰ê·  ëŒ€ë¹„ 20% ì´ìƒ ë‚®ì€ ê±°ë˜ (35ì )
        - **í‰ë‹¹ê°€ ì´ìƒ**: í‰ë‹¹ ê°€ê²©ì´ í‰ê·  ëŒ€ë¹„ 25% ì´ìƒ ì°¨ì´ (20ì )
        - **ê±°ë˜ í•´ì œ ì´ë ¥**: í•´ì œì‚¬ìœ ë°œìƒì¼ì´ ìˆëŠ” ê±°ë˜ (30ì )
        - **ì €ì¸µ ê³ ê°€**: 5ì¸µ ì´í•˜ì¸ë° í‰ê· ë³´ë‹¤ 10% ì´ìƒ ë†’ìŒ (15ì )
        - **ê³ ì¸µ ì €ê°€**: 20ì¸µ ì´ìƒì¸ë° í‰ê· ë³´ë‹¤ 10% ì´ìƒ ë‚®ìŒ (10ì )
        
        âš ï¸ **ì£¼ì˜ì‚¬í•­**
        - ì´ ì‹œìŠ¤í…œì€ í†µê³„ì  ë¶„ì„ì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ë©°, ì‹¤ì œ ì´ìƒê±°ë˜ ì—¬ë¶€ëŠ” ì¶”ê°€ ì¡°ì‚¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.
        - ì‹ ì¶•, ì¬ê±´ì¶•, ë¦¬ëª¨ë¸ë§ ë“± ì •ìƒì ì¸ ê°€ê²© ë³€ë™ë„ ì´ìƒê±°ë˜ë¡œ íƒì§€ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        - API í˜¸ì¶œ ì œí•œìœ¼ë¡œ ì¸í•´ í•œ ë²ˆì— ë§ì€ ì§€ì—­ì„ ì¡°íšŒí•˜ë©´ ì‹œê°„ì´ ì†Œìš”ë©ë‹ˆë‹¤.
        """)

if __name__ == "__main__":
    main()